// dev/croppie.min.js
(function(root,factory){if(typeof define==="function"&&define.amd){define(["exports"],factory)}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){factory(exports)}else{factory(root.commonJsStrict={})}})(this,function(exports){if(typeof Promise!=="function"){!function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void k(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=setTimeout,k="function"==typeof setImmediate&&setImmediate||function(a){j(a,1)},l=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},c._setImmediateFn=function(a){k=a},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this)}if(typeof window.CustomEvent!=="function"){(function(){function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent})()}if(!HTMLCanvasElement.prototype.toBlob){Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(callback,type,quality){var binStr=atob(this.toDataURL(type,quality).split(",")[1]),len=binStr.length,arr=new Uint8Array(len);for(var i=0;i<len;i++){arr[i]=binStr.charCodeAt(i)}callback(new Blob([arr],{type:type||"image/png"}))}})}var cssPrefixes=["Webkit","Moz","ms"],emptyStyles=document.createElement("div").style,CSS_TRANS_ORG,CSS_TRANSFORM,CSS_USERSELECT;function vendorPrefix(prop){if(prop in emptyStyles){return prop}var capProp=prop[0].toUpperCase()+prop.slice(1),i=cssPrefixes.length;while(i--){prop=cssPrefixes[i]+capProp;if(prop in emptyStyles){return prop}}}CSS_TRANSFORM=vendorPrefix("transform");CSS_TRANS_ORG=vendorPrefix("transformOrigin");CSS_USERSELECT=vendorPrefix("userSelect");function deepExtend(destination,source){destination=destination||{};for(var property in source){if(source[property]&&source[property].constructor&&source[property].constructor===Object){destination[property]=destination[property]||{};deepExtend(destination[property],source[property])}else{destination[property]=source[property]}}return destination}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}function dispatchChange(element){if("createEvent"in document){var evt=document.createEvent("HTMLEvents");evt.initEvent("change",false,true);element.dispatchEvent(evt)}else{element.fireEvent("onchange")}}function css(el,styles,val){if(typeof styles==="string"){var tmp=styles;styles={};styles[tmp]=val}for(var prop in styles){el.style[prop]=styles[prop]}}function addClass(el,c){if(el.classList){el.classList.add(c)}else{el.className+=" "+c}}function removeClass(el,c){if(el.classList){el.classList.remove(c)}else{el.className=el.className.replace(c,"")}}function num(v){return parseInt(v,10)}function loadImage(src,imageEl,useCanvas){var img=imageEl||new Image,prom;if(img.src===src){prom=new Promise(function(resolve,reject){resolve(img)})}else{img.removeAttribute("crossOrigin");prom=new Promise(function(resolve,reject){if(useCanvas&&src.match(/^https?:\/\/|^\/\//)){img.setAttribute("crossOrigin","anonymous")}img.onload=function(){setTimeout(function(){resolve(img)},1)}});img.src=src}img.style.opacity=0;return prom}var _TRANSLATE="translate3d",_TRANSLATE_SUFFIX=", 0px";var Transform=function(x,y,scale){this.x=parseFloat(x);this.y=parseFloat(y);this.scale=parseFloat(scale)};Transform.parse=function(v){if(v.style){return Transform.parse(v.style[CSS_TRANSFORM])}else if(v.indexOf("matrix")>-1||v.indexOf("none")>-1){return Transform.fromMatrix(v)}else{return Transform.fromString(v)}};Transform.fromMatrix=function(v){var vals=v.substring(7).split(",");if(!vals.length||v==="none"){vals=[1,0,0,1,0,0]}return new Transform(num(vals[4]),num(vals[5]),parseFloat(vals[0]))};Transform.fromString=function(v){var values=v.split(") "),translate=values[0].substring(_TRANSLATE.length+1).split(","),scale=values.length>1?values[1].substring(6):1,x=translate.length>1?translate[0]:0,y=translate.length>1?translate[1]:0;return new Transform(x,y,scale)};Transform.prototype.toString=function(){return _TRANSLATE+"("+this.x+"px, "+this.y+"px"+_TRANSLATE_SUFFIX+") scale("+this.scale+")"};var TransformOrigin=function(el){if(!el||!el.style[CSS_TRANS_ORG]){this.x=0;this.y=0;return}var css=el.style[CSS_TRANS_ORG].split(" ");this.x=parseFloat(css[0]);this.y=parseFloat(css[1])};TransformOrigin.prototype.toString=function(){return this.x+"px "+this.y+"px"};function getExifOrientation(img,cb){if(!window.EXIF){cb(0)}EXIF.getData(img,function(){var orientation=EXIF.getTag(this,"Orientation");cb(orientation)})}function drawCanvas(canvas,img,orientation){var width=img.width,height=img.height,ctx=canvas.getContext("2d");canvas.width=img.width;canvas.height=img.height;ctx.save();switch(orientation){case 2:ctx.translate(width,0);ctx.scale(-1,1);break;case 3:ctx.translate(width,height);ctx.rotate(180*Math.PI/180);break;case 4:ctx.translate(0,height);ctx.scale(1,-1);break;case 5:canvas.width=height;canvas.height=width;ctx.rotate(90*Math.PI/180);ctx.scale(1,-1);break;case 6:canvas.width=height;canvas.height=width;ctx.rotate(90*Math.PI/180);ctx.translate(0,-height);break;case 7:canvas.width=height;canvas.height=width;ctx.rotate(-90*Math.PI/180);ctx.translate(-width,height);ctx.scale(1,-1);break;case 8:canvas.width=height;canvas.height=width;ctx.translate(0,width);ctx.rotate(-90*Math.PI/180);break}ctx.drawImage(img,0,0,width,height);ctx.restore()}function _create(){var self=this,contClass="croppie-container",customViewportClass=self.options.viewport.type?"cr-vp-"+self.options.viewport.type:null,boundary,img,viewport,overlay,canvas,bw,bh;self.options.useCanvas=self.options.enableOrientation||_hasExif.call(self);self.data={};self.elements={};boundary=self.elements.boundary=document.createElement("div");viewport=self.elements.viewport=document.createElement("div");img=self.elements.img=document.createElement("img");overlay=self.elements.overlay=document.createElement("div");if(self.options.useCanvas){self.elements.canvas=document.createElement("canvas");self.elements.preview=self.elements.canvas}else{self.elements.preview=self.elements.img}addClass(boundary,"cr-boundary");bw=self.options.boundary.width;bh=self.options.boundary.height;css(boundary,{width:bw+(isNaN(bw)?"":"px"),height:bh+(isNaN(bh)?"":"px")});addClass(viewport,"cr-viewport");if(customViewportClass){addClass(viewport,customViewportClass)}css(viewport,{width:self.options.viewport.width+"px",height:self.options.viewport.height+"px"});viewport.setAttribute("tabindex",0);addClass(self.elements.preview,"cr-image");addClass(overlay,"cr-overlay");self.element.appendChild(boundary);boundary.appendChild(self.elements.preview);boundary.appendChild(viewport);boundary.appendChild(overlay);addClass(self.element,contClass);if(self.options.customClass){addClass(self.element,self.options.customClass)}_initDraggable.call(this);if(self.options.enableZoom){_initializeZoom.call(self)}}function _initRotationControls(){return;var self=this,wrap,btnLeft,btnRight,iLeft,iRight;wrap=document.createElement("div");self.elements.orientationBtnLeft=btnLeft=document.createElement("button");self.elements.orientationBtnRight=btnRight=document.createElement("button");wrap.appendChild(btnLeft);wrap.appendChild(btnRight);iLeft=document.createElement("i");iRight=document.createElement("i");btnLeft.appendChild(iLeft);btnRight.appendChild(iRight);addClass(wrap,"cr-rotate-controls");addClass(btnLeft,"cr-rotate-l");addClass(btnRight,"cr-rotate-r");self.elements.boundary.appendChild(wrap);btnLeft.addEventListener("click",function(){self.rotate(-90)});btnRight.addEventListener("click",function(){self.rotate(90)})}function _hasExif(){return this.options.enableExif&&window.EXIF}function _setZoomerVal(v){if(this.options.enableZoom){var z=this.elements.zoomer,val=fix(v,4);z.value=Math.max(z.min,Math.min(z.max,val))}}function _initializeZoom(){var self=this,wrap=self.elements.zoomerWrap=document.createElement("div"),zoomer=self.elements.zoomer=document.createElement("input");addClass(wrap,"cr-slider-wrap");addClass(zoomer,"cr-slider");zoomer.type="range";zoomer.step="0.0001";zoomer.value=1;zoomer.style.display=self.options.showZoomer?"":"none";self.element.appendChild(wrap);wrap.appendChild(zoomer);self._currentZoom=1;function change(){_onZoom.call(self,{value:parseFloat(zoomer.value),origin:new TransformOrigin(self.elements.preview),viewportRect:self.elements.viewport.getBoundingClientRect(),transform:Transform.parse(self.elements.preview)})}function scroll(ev){var delta,targetZoom;if(ev.wheelDelta){delta=ev.wheelDelta/1200}else if(ev.deltaY){delta=ev.deltaY/1060}else if(ev.detail){delta=ev.detail/-60}else{delta=0}targetZoom=self._currentZoom+delta*self._currentZoom;ev.preventDefault();_setZoomerVal.call(self,targetZoom);change.call(self)}self.elements.zoomer.addEventListener("input",change);self.elements.zoomer.addEventListener("change",change);if(self.options.mouseWheelZoom){self.elements.boundary.addEventListener("mousewheel",scroll);self.elements.boundary.addEventListener("DOMMouseScroll",scroll)}}function _onZoom(ui){var self=this,transform=ui?ui.transform:Transform.parse(self.elements.preview),vpRect=ui?ui.viewportRect:self.elements.viewport.getBoundingClientRect(),origin=ui?ui.origin:new TransformOrigin(self.elements.preview),transCss={};function applyCss(){var transCss={};transCss[CSS_TRANSFORM]=transform.toString();transCss[CSS_TRANS_ORG]=origin.toString();css(self.elements.preview,transCss)}self._currentZoom=ui?ui.value:self._currentZoom;transform.scale=self._currentZoom;applyCss();if(self.options.enforceBoundary){var boundaries=_getVirtualBoundaries.call(self,vpRect),transBoundaries=boundaries.translate,oBoundaries=boundaries.origin;if(transform.x>=transBoundaries.maxX){origin.x=oBoundaries.minX;transform.x=transBoundaries.maxX}if(transform.x<=transBoundaries.minX){origin.x=oBoundaries.maxX;transform.x=transBoundaries.minX}if(transform.y>=transBoundaries.maxY){origin.y=oBoundaries.minY;transform.y=transBoundaries.maxY}if(transform.y<=transBoundaries.minY){origin.y=oBoundaries.maxY;transform.y=transBoundaries.minY}}applyCss();_debouncedOverlay.call(self);_triggerUpdate.call(self)}function _getVirtualBoundaries(viewport){var self=this,scale=self._currentZoom,vpWidth=viewport.width,vpHeight=viewport.height,centerFromBoundaryX=self.elements.boundary.clientWidth/2,centerFromBoundaryY=self.elements.boundary.clientHeight/2,imgRect=self.elements.preview.getBoundingClientRect(),curImgWidth=imgRect.width,curImgHeight=imgRect.height,halfWidth=vpWidth/2,halfHeight=vpHeight/2;var maxX=(halfWidth/scale-centerFromBoundaryX)*-1;var minX=maxX-(curImgWidth*(1/scale)-vpWidth*(1/scale));var maxY=(halfHeight/scale-centerFromBoundaryY)*-1;var minY=maxY-(curImgHeight*(1/scale)-vpHeight*(1/scale));var originMinX=1/scale*halfWidth;var originMaxX=curImgWidth*(1/scale)-originMinX;var originMinY=1/scale*halfHeight;var originMaxY=curImgHeight*(1/scale)-originMinY;return{translate:{maxX:maxX,minX:minX,maxY:maxY,minY:minY},origin:{maxX:originMaxX,minX:originMinX,maxY:originMaxY,minY:originMinY}}}function _updateCenterPoint(){var self=this,scale=self._currentZoom,data=self.elements.preview.getBoundingClientRect(),vpData=self.elements.viewport.getBoundingClientRect(),transform=Transform.parse(self.elements.preview.style[CSS_TRANSFORM]),pc=new TransformOrigin(self.elements.preview),top=vpData.top-data.top+vpData.height/2,left=vpData.left-data.left+vpData.width/2,center={},adj={};center.y=top/scale;center.x=left/scale;adj.y=(center.y-pc.y)*(1-scale);adj.x=(center.x-pc.x)*(1-scale);transform.x-=adj.x;transform.y-=adj.y;var newCss={};newCss[CSS_TRANS_ORG]=center.x+"px "+center.y+"px";newCss[CSS_TRANSFORM]=transform.toString();css(self.elements.preview,newCss)}function _initDraggable(){var self=this,isDragging=false,originalX,originalY,originalDistance,vpRect,transform;function assignTransformCoordinates(deltaX,deltaY){var imgRect=self.elements.preview.getBoundingClientRect(),top=transform.y+deltaY,left=transform.x+deltaX;if(self.options.enforceBoundary){if(vpRect.top>imgRect.top+deltaY&&vpRect.bottom<imgRect.bottom+deltaY){transform.y=top}if(vpRect.left>imgRect.left+deltaX&&vpRect.right<imgRect.right+deltaX){transform.x=left}}else{transform.y=top;transform.x=left}}function keyDown(ev){var LEFT_ARROW=37,UP_ARROW=38,RIGHT_ARROW=39,DOWN_ARROW=40;if(ev.shiftKey&&(ev.keyCode==UP_ARROW||ev.keyCode==DOWN_ARROW)){var zoom=0;if(ev.keyCode==UP_ARROW){zoom=parseFloat(self.elements.zoomer.value,10)+parseFloat(self.elements.zoomer.step,10)}else{zoom=parseFloat(self.elements.zoomer.value,10)-parseFloat(self.elements.zoomer.step,10)}self.setZoom(zoom)}else if(ev.keyCode>=37&&ev.keyCode<=40){ev.preventDefault();var movement=parseKeyDown(ev.keyCode);transform=Transform.parse(self.elements.preview);document.body.style[CSS_USERSELECT]="none";vpRect=self.elements.viewport.getBoundingClientRect();keyMove(movement)}function parseKeyDown(key){switch(key){case LEFT_ARROW:return[1,0];case UP_ARROW:return[0,1];case RIGHT_ARROW:return[-1,0];case DOWN_ARROW:return[0,-1]}}}function keyMove(movement){var deltaX=movement[0],deltaY=movement[1],newCss={};assignTransformCoordinates(deltaX,deltaY);newCss[CSS_TRANSFORM]=transform.toString();css(self.elements.preview,newCss);_updateOverlay.call(self);document.body.style[CSS_USERSELECT]="";_updateCenterPoint.call(self);_triggerUpdate.call(self);originalDistance=0}function mouseDown(ev){ev.preventDefault();if(isDragging)return;isDragging=true;originalX=ev.pageX;originalY=ev.pageY;if(ev.touches){var touches=ev.touches[0];originalX=touches.pageX;originalY=touches.pageY}transform=Transform.parse(self.elements.preview);window.addEventListener("mousemove",mouseMove);window.addEventListener("touchmove",mouseMove);window.addEventListener("mouseup",mouseUp);window.addEventListener("touchend",mouseUp);document.body.style[CSS_USERSELECT]="none";vpRect=self.elements.viewport.getBoundingClientRect()}function mouseMove(ev){ev.preventDefault();var pageX=ev.pageX,pageY=ev.pageY;if(ev.touches){var touches=ev.touches[0];pageX=touches.pageX;pageY=touches.pageY}var deltaX=pageX-originalX,deltaY=pageY-originalY,newCss={};if(ev.type=="touchmove"){if(ev.touches.length>1){var touch1=ev.touches[0];var touch2=ev.touches[1];var dist=Math.sqrt((touch1.pageX-touch2.pageX)*(touch1.pageX-touch2.pageX)+(touch1.pageY-touch2.pageY)*(touch1.pageY-touch2.pageY));if(!originalDistance){originalDistance=dist/self._currentZoom}var scale=dist/originalDistance;_setZoomerVal.call(self,scale);dispatchChange(self.elements.zoomer);return}}assignTransformCoordinates(deltaX,deltaY);newCss[CSS_TRANSFORM]=transform.toString();css(self.elements.preview,newCss);_updateOverlay.call(self);originalY=pageY;originalX=pageX}function mouseUp(){isDragging=false;window.removeEventListener("mousemove",mouseMove);window.removeEventListener("touchmove",mouseMove);window.removeEventListener("mouseup",mouseUp);window.removeEventListener("touchend",mouseUp);document.body.style[CSS_USERSELECT]="";_updateCenterPoint.call(self);_triggerUpdate.call(self);originalDistance=0}self.elements.overlay.addEventListener("mousedown",mouseDown);self.elements.viewport.addEventListener("keydown",keyDown);self.elements.overlay.addEventListener("touchstart",mouseDown)}function _updateOverlay(){var self=this,boundRect=self.elements.boundary.getBoundingClientRect(),imgData=self.elements.preview.getBoundingClientRect();css(self.elements.overlay,{width:imgData.width+"px",height:imgData.height+"px",top:imgData.top-boundRect.top+"px",left:imgData.left-boundRect.left+"px"})}var _debouncedOverlay=debounce(_updateOverlay,500);function _triggerUpdate(){var self=this,data=self.get(),ev;if(!_isVisible.call(self)){return}self.options.update.call(self,data);if(self.$){self.$(self.element).trigger("update",data)}else{var ev;if(window.CustomEvent){ev=new CustomEvent("update",{detail:data})}else{ev=document.createEvent("CustomEvent");ev.initCustomEvent("update",true,true,data)}self.element.dispatchEvent(ev)}}function _isVisible(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function _updatePropertiesFromImage(){var self=this,minZoom=0,maxZoom=1.5,initialZoom=1,cssReset={},img=self.elements.preview,zoomer=self.elements.zoomer,transformReset=new Transform(0,0,initialZoom),originReset=new TransformOrigin,isVisible=_isVisible.call(self),imgData,vpData,boundaryData,minW,minH;if(!isVisible||self.data.bound){return}self.data.bound=true;cssReset[CSS_TRANSFORM]=transformReset.toString();cssReset[CSS_TRANS_ORG]=originReset.toString();cssReset["opacity"]=1;css(img,cssReset);imgData=img.getBoundingClientRect();vpData=self.elements.viewport.getBoundingClientRect();boundaryData=self.elements.boundary.getBoundingClientRect();self._originalImageWidth=imgData.width;self._originalImageHeight=imgData.height;if(self.options.enableZoom){if(self.options.enforceBoundary){minW=vpData.width/imgData.width;minH=vpData.height/imgData.height;minZoom=Math.max(minW,minH)}if(minZoom>=maxZoom){maxZoom=minZoom+1}zoomer.min=fix(minZoom,4);zoomer.max=fix(maxZoom,4);var defaultInitialZoom=Math.max(boundaryData.width/imgData.width,boundaryData.height/imgData.height);initialZoom=self.data.boundZoom!==null?self.data.boundZoom:defaultInitialZoom;_setZoomerVal.call(self,initialZoom);dispatchChange(zoomer)}else{self._currentZoom=initialZoom}transformReset.scale=self._currentZoom;cssReset[CSS_TRANSFORM]=transformReset.toString();css(img,cssReset);if(self.data.points.length){_bindPoints.call(self,self.data.points)}else{_centerImage.call(self)}_updateCenterPoint.call(self);_updateOverlay.call(self)}function _bindPoints(points){if(points.length!=4){throw"Croppie - Invalid number of points supplied: "+points}var self=this,pointsWidth=points[2]-points[0],vpData=self.elements.viewport.getBoundingClientRect(),boundRect=self.elements.boundary.getBoundingClientRect(),vpOffset={left:vpData.left-boundRect.left,top:vpData.top-boundRect.top},scale=vpData.width/pointsWidth,originTop=points[1],originLeft=points[0],transformTop=-1*points[1]+vpOffset.top,transformLeft=-1*points[0]+vpOffset.left,newCss={};newCss[CSS_TRANS_ORG]=originLeft+"px "+originTop+"px";newCss[CSS_TRANSFORM]=new Transform(transformLeft,transformTop,scale).toString();css(self.elements.preview,newCss);_setZoomerVal.call(self,scale);self._currentZoom=scale}function _centerImage(){var self=this,imgDim=self.elements.preview.getBoundingClientRect(),vpDim=self.elements.viewport.getBoundingClientRect(),boundDim=self.elements.boundary.getBoundingClientRect(),vpLeft=vpDim.left-boundDim.left,vpTop=vpDim.top-boundDim.top,w=vpLeft-(imgDim.width-vpDim.width)/2,h=vpTop-(imgDim.height-vpDim.height)/2,transform=new Transform(w,h,self._currentZoom);css(self.elements.preview,CSS_TRANSFORM,transform.toString())}function _transferImageToCanvas(customOrientation){var self=this,canvas=self.elements.canvas,img=self.elements.img,ctx=canvas.getContext("2d"),exif=_hasExif.call(self),customOrientation=self.options.enableOrientation&&customOrientation;ctx.clearRect(0,0,canvas.width,canvas.height);canvas.width=img.width;canvas.height=img.height;if(exif){getExifOrientation(img,function(orientation){drawCanvas(canvas,img,num(orientation,10));if(customOrientation){drawCanvas(canvas,img,customOrientation)}})}else if(customOrientation){drawCanvas(canvas,img,customOrientation)}}function _getCanvas(data){var self=this,points=data.points,left=num(points[0]),top=num(points[1]),width=points[2]-points[0],height=points[3]-points[1],circle=data.circle,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),outWidth=width,outHeight=height,startX=0,startY=0;if(data.outputWidth&&data.outputHeight){outWidth=data.outputWidth;outHeight=data.outputHeight}canvas.width=outWidth;canvas.height=outHeight;if(data.backgroundColor){ctx.fillStyle=data.backgroundColor;ctx.fillRect(0,0,outWidth,outHeight)}if(left<0){startX=Math.abs(left);left=0}if(top<0){startY=Math.abs(top);top=0}if(left+width>self._originalImageWidth){width=self._originalImageWidth-left;outWidth=width}if(top+height>self._originalImageHeight){height=self._originalImageHeight-top;outHeight=height}ctx.drawImage(this.elements.preview,left,top,width,height,startX,startY,outWidth,outHeight);if(circle){ctx.fillStyle="#fff";ctx.globalCompositeOperation="destination-in";ctx.beginPath();ctx.arc(outWidth/2,outHeight/2,outWidth/2,0,Math.PI*2,true);ctx.closePath();ctx.fill()}return canvas}function _getHtmlResult(data){var points=data.points,div=document.createElement("div"),img=document.createElement("img"),width=points[2]-points[0],height=points[3]-points[1];addClass(div,"croppie-result");div.appendChild(img);css(img,{left:-1*points[0]+"px",top:-1*points[1]+"px"});img.src=data.url;css(div,{width:width+"px",height:height+"px"});return div}function _getBase64Result(data){return _getCanvas.call(this,data).toDataURL(data.format,data.quality)}function _getBlobResult(data){var self=this;return new Promise(function(resolve,reject){_getCanvas.call(self,data).toBlob(function(blob){resolve(blob)},data.format,data.quality)})}function _bind(options,cb){var self=this,url,points=[],zoom=null;if(typeof options==="string"){url=options;options={}}else if(Array.isArray(options)){points=options.slice()}else if(typeof options=="undefined"&&self.data.url){_updatePropertiesFromImage.call(self);_triggerUpdate.call(self);return null}else{url=options.url;points=options.points||[];zoom=typeof options.zoom==="undefined"?null:options.zoom}self.data.bound=false;self.data.url=url||self.data.url;self.data.points=(points||self.data.points).map(function(p){return parseFloat(p)});self.data.boundZoom=zoom;var prom=loadImage(url,self.elements.img,self.options.useCanvas);prom.then(function(){if(self.options.useCanvas){self.elements.img.exifdata=null;_transferImageToCanvas.call(self,options.orientation||1)}_updatePropertiesFromImage.call(self);_triggerUpdate.call(self);if(cb){cb()}});return prom}function fix(v,decimalPoints){return parseFloat(v).toFixed(decimalPoints||0)}function _get(){var self=this,imgData=self.elements.preview.getBoundingClientRect(),vpData=self.elements.viewport.getBoundingClientRect(),x1=vpData.left-imgData.left,y1=vpData.top-imgData.top,widthDiff=(vpData.width-self.elements.viewport.offsetWidth)/2,heightDiff=(vpData.height-self.elements.viewport.offsetHeight)/2,x2=x1+self.elements.viewport.offsetWidth+widthDiff,y2=y1+self.elements.viewport.offsetHeight+heightDiff,scale=self._currentZoom;if(scale===Infinity||isNaN(scale)){scale=1}var max=self.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;x1=Math.max(max,x1/scale);y1=Math.max(max,y1/scale);x2=Math.max(max,x2/scale);y2=Math.max(max,y2/scale);return{points:[fix(x1),fix(y1),fix(x2),fix(y2)],zoom:scale}}var RESULT_DEFAULTS={type:"canvas",format:"png",quality:1},RESULT_FORMATS=["jpeg","webp","png"];function _result(options){var self=this,data=_get.call(self),opts=deepExtend(RESULT_DEFAULTS,deepExtend({},options)),resultType=typeof options==="string"?options:opts.type||"base64",size=opts.size,format=opts.format,quality=opts.quality,backgroundColor=opts.backgroundColor,circle=typeof opts.circle==="boolean"?opts.circle:self.options.viewport.type==="circle",vpRect=self.elements.viewport.getBoundingClientRect(),ratio=vpRect.width/vpRect.height,prom;if(size==="viewport"){data.outputWidth=vpRect.width;data.outputHeight=vpRect.height}else if(typeof size==="object"){if(size.width&&size.height){data.outputWidth=size.width;data.outputHeight=size.height}else if(size.width){data.outputWidth=size.width;data.outputHeight=size.width/ratio}else if(size.height){data.outputWidth=size.height*ratio;data.outputHeight=size.height}}if(RESULT_FORMATS.indexOf(format)>-1){data.format="image/"+format;data.quality=quality}data.circle=circle;data.url=self.data.url;data.backgroundColor=backgroundColor;prom=new Promise(function(resolve,reject){switch(resultType.toLowerCase()){case"rawcanvas":resolve(_getCanvas.call(self,data));break;case"canvas":case"base64":resolve(_getBase64Result.call(self,data));break;case"blob":_getBlobResult.call(self,data).then(resolve);break;default:resolve(_getHtmlResult.call(self,data));break}});return prom}function _refresh(){_updatePropertiesFromImage.call(this)}function _rotate(deg){if(!this.options.useCanvas){throw"Croppie: Cannot rotate without enableOrientation"}var self=this,canvas=self.elements.canvas,img=self.elements.img,copy=document.createElement("canvas"),ornt=1;copy.width=canvas.width;copy.height=canvas.height;var ctx=copy.getContext("2d");ctx.drawImage(canvas,0,0);if(deg===90||deg===-270)ornt=6;if(deg===-90||deg===270)ornt=8;if(deg===180||deg===-180)ornt=3;drawCanvas(canvas,copy,ornt);_onZoom.call(self)}function _destroy(){var self=this;self.element.removeChild(self.elements.boundary);removeClass(self.element,"croppie-container");if(self.options.enableZoom){self.element.removeChild(self.elements.zoomerWrap)}delete self.elements}if(window.jQuery){var $=window.jQuery;$.fn.croppie=function(opts){var ot=typeof opts;if(ot==="string"){var args=Array.prototype.slice.call(arguments,1);var singleInst=$(this).data("croppie");if(opts==="get"){return singleInst.get()}else if(opts==="result"){return singleInst.result.apply(singleInst,args)}else if(opts==="bind"){return singleInst.bind.apply(singleInst,args)}return this.each(function(){var i=$(this).data("croppie");if(!i)return;var method=i[opts];if($.isFunction(method)){method.apply(i,args);if(opts==="destroy"){$(this).removeData("croppie")}}else{throw"Croppie "+opts+" method not found"}})}else{return this.each(function(){var i=new Croppie(this,opts);i.$=$;$(this).data("croppie",i)})}}}function Croppie(element,opts){this.element=element;this.options=deepExtend(deepExtend({},Croppie.defaults),opts);if(this.element.tagName.toLowerCase()==="img"){var origImage=this.element;addClass(origImage,"cr-original-image");var replacementDiv=document.createElement("div");this.element.parentNode.appendChild(replacementDiv);replacementDiv.appendChild(origImage);this.element=replacementDiv;this.options.url=this.options.url||origImage.src}_create.call(this);if(this.options.url){var bindOpts={url:this.options.url,points:this.options.points};delete this.options["url"];delete this.options["points"];_bind.call(this,bindOpts)}}Croppie.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:true,leftClass:"",rightClass:""},customClass:"",showZoomer:true,enableZoom:true,mouseWheelZoom:true,enableExif:false,enforceBoundary:true,enableOrientation:false,update:function(){}};deepExtend(Croppie.prototype,{bind:function(options,cb){return _bind.call(this,options,cb)},get:function(){return _get.call(this)},result:function(type){return _result.call(this,type)},refresh:function(){return _refresh.call(this)},setZoom:function(v){_setZoomerVal.call(this,v);dispatchChange(this.elements.zoomer)},rotate:function(deg){_rotate.call(this,deg)},destroy:function(){return _destroy.call(this)}});exports.Croppie=window.Croppie=Croppie;if(typeof module==="object"&&!!module.exports){module.exports=Croppie}});

// dev/nouislider.min.js
/*! nouislider - 12.1.0 - 10/25/2018 */
!function(t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():window.noUiSlider=t()}(function(){"use strict";var et="12.1.0";function s(t){return null!=t}function rt(t){t.preventDefault()}function i(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function nt(t,e,r){0<r&&(at(t,e),setTimeout(function(){st(t,e)},r))}function it(t){return Math.max(Math.min(t,100),0)}function ot(t){return Array.isArray(t)?t:[t]}function e(t){var e=(t=String(t)).split(".");return 1<e.length?e[1].length:0}function at(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function st(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function lt(t){var e=void 0!==window.pageXOffset,r="CSS1Compat"===(t.compatMode||"");return{x:e?window.pageXOffset:r?t.documentElement.scrollLeft:t.body.scrollLeft,y:e?window.pageYOffset:r?t.documentElement.scrollTop:t.body.scrollTop}}function c(t,e){return 100/(e-t)}function p(t,e){return 100*e/(t[1]-t[0])}function f(t,e){for(var r=1;t>=e[r];)r+=1;return r}function r(t,e,r){if(r>=t.slice(-1)[0])return 100;var n,i,o=f(r,t),a=t[o-1],s=t[o],l=e[o-1],u=e[o];return l+(i=r,p(n=[a,s],n[0]<0?i+Math.abs(n[0]):i-n[0])/c(l,u))}function n(t,e,r,n){if(100===n)return n;var i,o,a=f(n,t),s=t[a-1],l=t[a];return r?(l-s)/2<n-s?l:s:e[a-1]?t[a-1]+(i=n-t[a-1],o=e[a-1],Math.round(i/o)*o):n}function o(t,e,r){var n;if("number"==typeof e&&(e=[e]),!Array.isArray(e))throw new Error("noUiSlider ("+et+"): 'range' contains invalid value.");if(!i(n="min"===t?0:"max"===t?100:parseFloat(t))||!i(e[0]))throw new Error("noUiSlider ("+et+"): 'range' value isn't numeric.");r.xPct.push(n),r.xVal.push(e[0]),n?r.xSteps.push(!isNaN(e[1])&&e[1]):isNaN(e[1])||(r.xSteps[0]=e[1]),r.xHighestCompleteStep.push(0)}function a(t,e,r){if(!e)return!0;r.xSteps[t]=p([r.xVal[t],r.xVal[t+1]],e)/c(r.xPct[t],r.xPct[t+1]);var n=(r.xVal[t+1]-r.xVal[t])/r.xNumSteps[t],i=Math.ceil(Number(n.toFixed(3))-1),o=r.xVal[t]+r.xNumSteps[t]*i;r.xHighestCompleteStep[t]=o}function l(t,e,r){var n;this.xPct=[],this.xVal=[],this.xSteps=[r||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=e;var i=[];for(n in t)t.hasOwnProperty(n)&&i.push([t[n],n]);for(i.length&&"object"==typeof i[0][0]?i.sort(function(t,e){return t[0][0]-e[0][0]}):i.sort(function(t,e){return t[0]-e[0]}),n=0;n<i.length;n++)o(i[n][1],i[n][0],this);for(this.xNumSteps=this.xSteps.slice(0),n=0;n<this.xNumSteps.length;n++)a(n,this.xNumSteps[n],this)}l.prototype.getMargin=function(t){var e=this.xNumSteps[0];if(e&&t/e%1!=0)throw new Error("noUiSlider ("+et+"): 'limit', 'margin' and 'padding' must be divisible by step.");return 2===this.xPct.length&&p(this.xVal,t)},l.prototype.toStepping=function(t){return t=r(this.xVal,this.xPct,t)},l.prototype.fromStepping=function(t){return function(t,e,r){if(100<=r)return t.slice(-1)[0];var n,i=f(r,e),o=t[i-1],a=t[i],s=e[i-1],l=e[i];return n=[o,a],(r-s)*c(s,l)*(n[1]-n[0])/100+n[0]}(this.xVal,this.xPct,t)},l.prototype.getStep=function(t){return t=n(this.xPct,this.xSteps,this.snap,t)},l.prototype.getNearbySteps=function(t){var e=f(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e],step:this.xNumSteps[e],highestStep:this.xHighestCompleteStep[e]}}},l.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(e);return Math.max.apply(null,t)},l.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var u={to:function(t){return void 0!==t&&t.toFixed(2)},from:Number};function d(t){if("object"==typeof(e=t)&&"function"==typeof e.to&&"function"==typeof e.from)return!0;var e;throw new Error("noUiSlider ("+et+"): 'format' requires 'to' and 'from' methods.")}function h(t,e){if(!i(e))throw new Error("noUiSlider ("+et+"): 'step' is not numeric.");t.singleStep=e}function m(t,e){if("object"!=typeof e||Array.isArray(e))throw new Error("noUiSlider ("+et+"): 'range' is not an object.");if(void 0===e.min||void 0===e.max)throw new Error("noUiSlider ("+et+"): Missing 'min' or 'max' in 'range'.");if(e.min===e.max)throw new Error("noUiSlider ("+et+"): 'range' 'min' and 'max' cannot be equal.");t.spectrum=new l(e,t.snap,t.singleStep)}function g(t,e){if(e=ot(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider ("+et+"): 'start' option is incorrect.");t.handles=e.length,t.start=e}function v(t,e){if("boolean"!=typeof(t.snap=e))throw new Error("noUiSlider ("+et+"): 'snap' option must be a boolean.")}function b(t,e){if("boolean"!=typeof(t.animate=e))throw new Error("noUiSlider ("+et+"): 'animate' option must be a boolean.")}function S(t,e){if("number"!=typeof(t.animationDuration=e))throw new Error("noUiSlider ("+et+"): 'animationDuration' option must be a number.")}function w(t,e){var r,n=[!1];if("lower"===e?e=[!0,!1]:"upper"===e&&(e=[!1,!0]),!0===e||!1===e){for(r=1;r<t.handles;r++)n.push(e);n.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider ("+et+"): 'connect' option doesn't match handle count.");n=e}t.connect=n}function x(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider ("+et+"): 'orientation' option is invalid.")}}function y(t,e){if(!i(e))throw new Error("noUiSlider ("+et+"): 'margin' option must be numeric.");if(0!==e&&(t.margin=t.spectrum.getMargin(e),!t.margin))throw new Error("noUiSlider ("+et+"): 'margin' option is only supported on linear sliders.")}function E(t,e){if(!i(e))throw new Error("noUiSlider ("+et+"): 'limit' option must be numeric.");if(t.limit=t.spectrum.getMargin(e),!t.limit||t.handles<2)throw new Error("noUiSlider ("+et+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function C(t,e){if(!i(e)&&!Array.isArray(e))throw new Error("noUiSlider ("+et+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&2!==e.length&&!i(e[0])&&!i(e[1]))throw new Error("noUiSlider ("+et+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==e){if(Array.isArray(e)||(e=[e,e]),!(t.padding=[t.spectrum.getMargin(e[0]),t.spectrum.getMargin(e[1])])===t.padding[0]||!1===t.padding[1])throw new Error("noUiSlider ("+et+"): 'padding' option is only supported on linear sliders.");if(t.padding[0]<0||t.padding[1]<0)throw new Error("noUiSlider ("+et+"): 'padding' option must be a positive number(s).");if(100<=t.padding[0]+t.padding[1])throw new Error("noUiSlider ("+et+"): 'padding' option must not exceed 100% of the range.")}}function N(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider ("+et+"): 'direction' option was not recognized.")}}function U(t,e){if("string"!=typeof e)throw new Error("noUiSlider ("+et+"): 'behaviour' must be a string containing options.");var r=0<=e.indexOf("tap"),n=0<=e.indexOf("drag"),i=0<=e.indexOf("fixed"),o=0<=e.indexOf("snap"),a=0<=e.indexOf("hover"),s=0<=e.indexOf("unconstrained");if(i){if(2!==t.handles)throw new Error("noUiSlider ("+et+"): 'fixed' behaviour must be used with 2 handles");y(t,t.start[1]-t.start[0])}if(s&&(t.margin||t.limit))throw new Error("noUiSlider ("+et+"): 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:r||o,drag:n,fixed:i,snap:o,hover:a,unconstrained:s}}function k(t,e){if(!1!==e)if(!0===e){t.tooltips=[];for(var r=0;r<t.handles;r++)t.tooltips.push(!0)}else{if(t.tooltips=ot(e),t.tooltips.length!==t.handles)throw new Error("noUiSlider ("+et+"): must pass a formatter for all handles.");t.tooltips.forEach(function(t){if("boolean"!=typeof t&&("object"!=typeof t||"function"!=typeof t.to))throw new Error("noUiSlider ("+et+"): 'tooltips' must be passed a formatter or 'false'.")})}}function P(t,e){d(t.ariaFormat=e)}function A(t,e){d(t.format=e)}function M(t,e){if("boolean"!=typeof(t.keyboardSupport=e))throw new Error("noUiSlider ("+et+"): 'keyboardSupport' option must be a boolean.")}function V(t,e){t.documentElement=e}function O(t,e){if("string"!=typeof e&&!1!==e)throw new Error("noUiSlider ("+et+"): 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function L(t,e){if("object"!=typeof e)throw new Error("noUiSlider ("+et+"): 'cssClasses' must be an object.");if("string"==typeof t.cssPrefix)for(var r in t.cssClasses={},e)e.hasOwnProperty(r)&&(t.cssClasses[r]=t.cssPrefix+e[r]);else t.cssClasses=e}function ut(e){var r={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:u,format:u},n={step:{r:!1,t:h},start:{r:!0,t:g},connect:{r:!0,t:w},direction:{r:!0,t:N},snap:{r:!1,t:v},animate:{r:!1,t:b},animationDuration:{r:!1,t:S},range:{r:!0,t:m},orientation:{r:!1,t:x},margin:{r:!1,t:y},limit:{r:!1,t:E},padding:{r:!1,t:C},behaviour:{r:!0,t:U},ariaFormat:{r:!1,t:P},format:{r:!1,t:A},tooltips:{r:!1,t:k},keyboardSupport:{r:!0,t:M},documentElement:{r:!1,t:V},cssPrefix:{r:!0,t:O},cssClasses:{r:!0,t:L}},i={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"}};e.format&&!e.ariaFormat&&(e.ariaFormat=e.format),Object.keys(n).forEach(function(t){if(!s(e[t])&&void 0===i[t]){if(n[t].r)throw new Error("noUiSlider ("+et+"): '"+t+"' is required.");return!0}n[t].t(r,s(e[t])?e[t]:i[t])}),r.pips=e.pips;var t=document.createElement("div"),o=void 0!==t.style.msTransform,a=void 0!==t.style.transform;r.transformRule=a?"transform":o?"msTransform":"webkitTransform";return r.style=[["left","top"],["right","bottom"]][r.dir][r.ort],r}function z(t,f,o){var l,u,s,a,c,e,p,i,d=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},h=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}(),y=t,m=[],g=[],v=0,E=f.spectrum,b=[],S={},w=t.ownerDocument,x=f.documentElement||w.documentElement,C=w.body,N=-1,U=0,k=1,P=2,A="rtl"===w.dir||1===f.ort?0:100;function M(t,e){var r=w.createElement("div");return e&&at(r,e),t.appendChild(r),r}function V(t,e){return!!e&&M(t,f.cssClasses.connect)}function r(t,e){return!!f.tooltips[e]&&M(t.firstChild,f.cssClasses.tooltip)}function O(e,i,o){var a=w.createElement("div"),s=[];s[U]=f.cssClasses.valueNormal,s[k]=f.cssClasses.valueLarge,s[P]=f.cssClasses.valueSub;var l=[];l[U]=f.cssClasses.markerNormal,l[k]=f.cssClasses.markerLarge,l[P]=f.cssClasses.markerSub;var u=[f.cssClasses.valueHorizontal,f.cssClasses.valueVertical],c=[f.cssClasses.markerHorizontal,f.cssClasses.markerVertical];function p(t,e){var r=e===f.cssClasses.value,n=r?s:l;return e+" "+(r?u:c)[f.ort]+" "+n[t]}return at(a,f.cssClasses.pips),at(a,0===f.ort?f.cssClasses.pipsHorizontal:f.cssClasses.pipsVertical),Object.keys(e).forEach(function(t){!function(t,e,r){if((r=i?i(e,r):r)!==N){var n=M(a,!1);n.className=p(r,f.cssClasses.marker),n.style[f.style]=t+"%",U<r&&((n=M(a,!1)).className=p(r,f.cssClasses.value),n.setAttribute("data-value",e),n.style[f.style]=t+"%",n.innerHTML=o.to(e))}}(t,e[t][0],e[t][1])}),a}function L(){var t;c&&((t=c).parentElement.removeChild(t),c=null)}function z(t){L();var m,g,v,b,e,r,S,w,x,n=t.mode,i=t.density||1,o=t.filter||!1,a=function(t,e,r){if("range"===t||"steps"===t)return E.xVal;if("count"===t){if(e<2)throw new Error("noUiSlider ("+et+"): 'values' (>= 2) required for mode 'count'.");var n=e-1,i=100/n;for(e=[];n--;)e[n]=n*i;e.push(100),t="positions"}return"positions"===t?e.map(function(t){return E.fromStepping(r?E.getStep(t):t)}):"values"===t?r?e.map(function(t){return E.fromStepping(E.getStep(E.toStepping(t)))}):e:void 0}(n,t.values||!1,t.stepped||!1),s=(m=i,g=n,v=a,b={},e=E.xVal[0],r=E.xVal[E.xVal.length-1],w=S=!1,x=0,(v=v.slice().sort(function(t,e){return t-e}).filter(function(t){return!this[t]&&(this[t]=!0)},{}))[0]!==e&&(v.unshift(e),S=!0),v[v.length-1]!==r&&(v.push(r),w=!0),v.forEach(function(t,e){var r,n,i,o,a,s,l,u,c,p,f=t,d=v[e+1],h="steps"===g;if(h&&(r=E.xNumSteps[e]),r||(r=d-f),!1!==f&&void 0!==d)for(r=Math.max(r,1e-7),n=f;n<=d;n=(n+r).toFixed(7)/1){for(u=(a=(o=E.toStepping(n))-x)/m,p=a/(c=Math.round(u)),i=1;i<=c;i+=1)b[(s=x+i*p).toFixed(5)]=[E.fromStepping(s),0];l=-1<v.indexOf(n)?k:h?P:U,!e&&S&&(l=0),n===d&&w||(b[o.toFixed(5)]=[n,l]),x=o}}),b),l=t.format||{to:Math.round};return c=y.appendChild(O(s,o,l))}function j(){var t=l.getBoundingClientRect(),e="offset"+["Width","Height"][f.ort];return 0===f.ort?t.width||l[e]:t.height||l[e]}function F(n,i,o,a){var e=function(t){return!!(t=function(t,e,r){var n,i,o=0===t.type.indexOf("touch"),a=0===t.type.indexOf("mouse"),s=0===t.type.indexOf("pointer");0===t.type.indexOf("MSPointer")&&(s=!0);if(o){var l=function(t){return t.target===r||r.contains(t.target)};if("touchstart"===t.type){var u=Array.prototype.filter.call(t.touches,l);if(1<u.length)return!1;n=u[0].pageX,i=u[0].pageY}else{var c=Array.prototype.find.call(t.changedTouches,l);if(!c)return!1;n=c.pageX,i=c.pageY}}e=e||lt(w),(a||s)&&(n=t.clientX+e.x,i=t.clientY+e.y);return t.pageOffset=e,t.points=[n,i],t.cursor=a||s,t}(t,a.pageOffset,a.target||i))&&(!(y.hasAttribute("disabled")&&!a.doNotReject)&&(e=y,r=f.cssClasses.tap,!((e.classList?e.classList.contains(r):new RegExp("\\b"+r+"\\b").test(e.className))&&!a.doNotReject)&&(!(n===d.start&&void 0!==t.buttons&&1<t.buttons)&&((!a.hover||!t.buttons)&&(h||t.preventDefault(),t.calcPoint=t.points[f.ort],void o(t,a))))));var e,r},r=[];return n.split(" ").forEach(function(t){i.addEventListener(t,e,!!h&&{passive:!0}),r.push([t,e])}),r}function H(t){var e,r,n,i,o,a,s=100*(t-(e=l,r=f.ort,n=e.getBoundingClientRect(),i=e.ownerDocument,o=i.documentElement,a=lt(i),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(a.x=0),r?n.top+a.y-o.clientTop:n.left+a.x-o.clientLeft))/j();return s=it(s),f.dir?100-s:s}function D(t,e){"mouseout"===t.type&&"HTML"===t.target.nodeName&&null===t.relatedTarget&&R(t,e)}function T(t,e){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===t.buttons&&0!==e.buttonsProperty)return R(t,e);var r=(f.dir?-1:1)*(t.calcPoint-e.startCalcPoint);$(0<r,100*r/e.baseSize,e.locations,e.handleNumbers)}function R(t,e){e.handle&&(st(e.handle,f.cssClasses.active),v-=1),e.listeners.forEach(function(t){x.removeEventListener(t[0],t[1])}),0===v&&(st(y,f.cssClasses.drag),J(),t.cursor&&(C.style.cursor="",C.removeEventListener("selectstart",rt))),e.handleNumbers.forEach(function(t){Y("change",t),Y("set",t),Y("end",t)})}function q(t,e){var r;if(1===e.handleNumbers.length){var n=u[e.handleNumbers[0]];if(n.hasAttribute("disabled"))return!1;r=n.children[0],v+=1,at(r,f.cssClasses.active)}t.stopPropagation();var i=[],o=F(d.move,x,T,{target:t.target,handle:r,listeners:i,startCalcPoint:t.calcPoint,baseSize:j(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:m.slice()}),a=F(d.end,x,R,{target:t.target,handle:r,listeners:i,doNotReject:!0,handleNumbers:e.handleNumbers}),s=F("mouseout",x,D,{target:t.target,handle:r,listeners:i,doNotReject:!0,handleNumbers:e.handleNumbers});i.push.apply(i,o.concat(a,s)),t.cursor&&(C.style.cursor=getComputedStyle(t.target).cursor,1<u.length&&at(y,f.cssClasses.drag),C.addEventListener("selectstart",rt,!1)),e.handleNumbers.forEach(function(t){Y("start",t)})}function n(t){t.stopPropagation();var n,i,o,e=H(t.calcPoint),r=(n=e,o=!(i=100),u.forEach(function(t,e){if(!t.hasAttribute("disabled")){var r=Math.abs(m[e]-n);(r<i||100===r&&100===i)&&(o=e,i=r)}}),o);if(!1===r)return!1;f.events.snap||nt(y,f.cssClasses.tap,f.animationDuration),K(r,e,!0,!0),J(),Y("slide",r,!0),Y("update",r,!0),Y("change",r,!0),Y("set",r,!0),f.events.snap&&q(t,{handleNumbers:[r]})}function B(t){var e=H(t.calcPoint),r=E.getStep(e),n=E.fromStepping(r);Object.keys(S).forEach(function(t){"hover"===t.split(".")[0]&&S[t].forEach(function(t){t.call(a,n)})})}function X(t,e){S[t]=S[t]||[],S[t].push(e),"update"===t.split(".")[0]&&u.forEach(function(t,e){Y("update",e)})}function Y(r,n,i){Object.keys(S).forEach(function(t){var e=t.split(".")[0];r===e&&S[t].forEach(function(t){t.call(a,b.map(f.format.to),n,b.slice(),i||!1,m.slice())})})}function _(t){return t+"%"}function I(t,e,r,n,i,o){return 1<u.length&&!f.events.unconstrained&&(n&&0<e&&(r=Math.max(r,t[e-1]+f.margin)),i&&e<u.length-1&&(r=Math.min(r,t[e+1]-f.margin))),1<u.length&&f.limit&&(n&&0<e&&(r=Math.min(r,t[e-1]+f.limit)),i&&e<u.length-1&&(r=Math.max(r,t[e+1]-f.limit))),f.padding&&(0===e&&(r=Math.max(r,f.padding[0])),e===u.length-1&&(r=Math.min(r,100-f.padding[1]))),!((r=it(r=E.getStep(r)))===t[e]&&!o)&&r}function W(t,e){var r=f.ort;return(r?e:t)+", "+(r?t:e)}function $(t,n,r,e){var i=r.slice(),o=[!t,t],a=[t,!t];e=e.slice(),t&&e.reverse(),1<e.length?e.forEach(function(t,e){var r=I(i,t,i[t]+n,o[e],a[e],!1);!1===r?n=0:(n=r-i[t],i[t]=r)}):o=a=[!0];var s=!1;e.forEach(function(t,e){s=K(t,r[t]+n,o[e],a[e])||s}),s&&e.forEach(function(t){Y("update",t),Y("slide",t)})}function G(t,e){return f.dir?100-t-e:t}function J(){g.forEach(function(t){var e=50<m[t]?-1:1,r=3+(u.length+e*t);u[t].style.zIndex=r})}function K(t,e,r,n){return!1!==(e=I(m,t,e,r,n,!1))&&(function(t,e){m[t]=e,b[t]=E.fromStepping(e);var r="translate("+W(_(G(e,0)-A),"0")+")";u[t].style[f.transformRule]=r,Q(t),Q(t+1)}(t,e),!0)}function Q(t){if(s[t]){var e=0,r=100;0!==t&&(e=m[t-1]),t!==s.length-1&&(r=m[t]);var n=r-e,i="translate("+W(_(G(e,n)),"0")+")",o="scale("+W(n/100,"1")+")";s[t].style[f.transformRule]=i+" "+o}}function Z(t,e){var n=ot(t),r=void 0===m[0];e=void 0===e||!!e,f.animate&&!r&&nt(y,f.cssClasses.tap,f.animationDuration),g.forEach(function(t){var e,r;K(t,(e=n[t],r=t,null===e||!1===e||void 0===e?m[r]:("number"==typeof e&&(e=String(e)),e=f.format.from(e),!1===(e=E.toStepping(e))||isNaN(e)?m[r]:e)),!0,!1)}),g.forEach(function(t){K(t,m[t],!0,!0)}),J(),g.forEach(function(t){Y("update",t),null!==n[t]&&e&&Y("set",t)})}function tt(){var t=b.map(f.format.to);return 1===t.length?t[0]:t}return at(e=y,f.cssClasses.target),0===f.dir?at(e,f.cssClasses.ltr):at(e,f.cssClasses.rtl),0===f.ort?at(e,f.cssClasses.horizontal):at(e,f.cssClasses.vertical),l=M(e,f.cssClasses.base),function(t,e){var r,n,i,o=M(e,f.cssClasses.connects);u=[],(s=[]).push(V(o,t[0]));for(var a=0;a<f.handles;a++)u.push((r=a,i=void 0,n=M(e,f.cssClasses.origin),(i=M(n,f.cssClasses.handle)).setAttribute("data-handle",r),f.keyboardSupport&&i.setAttribute("tabindex","0"),i.setAttribute("role","slider"),i.setAttribute("aria-orientation",f.ort?"vertical":"horizontal"),0===r?at(i,f.cssClasses.handleLower):r===f.handles-1&&at(i,f.cssClasses.handleUpper),n)),g[a]=a,s.push(V(o,t[a+1]))}(f.connect,l),(p=f.events).fixed||u.forEach(function(t,e){F(d.start,t.children[0],q,{handleNumbers:[e]})}),p.tap&&F(d.start,l,n,{}),p.hover&&F(d.move,l,B,{hover:!0}),p.drag&&s.forEach(function(t,e){if(!1!==t&&0!==e&&e!==s.length-1){var r=u[e-1],n=u[e],i=[t];at(t,f.cssClasses.draggable),p.fixed&&(i.push(r.children[0]),i.push(n.children[0])),i.forEach(function(t){F(d.start,t,q,{handles:[r,n],handleNumbers:[e-1,e]})})}}),Z(f.start),a={destroy:function(){for(var t in f.cssClasses)f.cssClasses.hasOwnProperty(t)&&st(y,f.cssClasses[t]);for(;y.firstChild;)y.removeChild(y.firstChild);delete y.noUiSlider},steps:function(){return m.map(function(t,e){var r=E.getNearbySteps(t),n=b[e],i=r.thisStep.step,o=null;!1!==i&&n+i>r.stepAfter.startValue&&(i=r.stepAfter.startValue-n),o=n>r.thisStep.startValue?r.thisStep.step:!1!==r.stepBefore.step&&n-r.stepBefore.highestStep,100===t?i=null:0===t&&(o=null);var a=E.countStepDecimals();return null!==i&&!1!==i&&(i=Number(i.toFixed(a))),null!==o&&!1!==o&&(o=Number(o.toFixed(a))),[o,i]})},on:X,off:function(t){var n=t&&t.split(".")[0],i=n&&t.substring(n.length);Object.keys(S).forEach(function(t){var e=t.split(".")[0],r=t.substring(e.length);n&&n!==e||i&&i!==r||delete S[t]})},get:tt,set:Z,setHandle:function(t,e,r){var n=[];if(!(0<=(t=Number(t))&&t<g.length))throw new Error("noUiSlider ("+et+"): invalid handle number, got: "+t);for(var i=0;i<g.length;i++)n[i]=null;n[t]=e,Z(n,r)},reset:function(t){Z(f.start,t)},__moveHandles:function(t,e,r){$(t,e,m,r)},options:o,updateOptions:function(e,t){var r=tt(),n=["margin","limit","padding","range","animate","snap","step","format"];n.forEach(function(t){void 0!==e[t]&&(o[t]=e[t])});var i=ut(o);n.forEach(function(t){void 0!==e[t]&&(f[t]=i[t])}),E=i.spectrum,f.margin=i.margin,f.limit=i.limit,f.padding=i.padding,f.pips&&z(f.pips),m=[],Z(e.start||r,t)},target:y,removePips:L,pips:z},f.pips&&z(f.pips),f.tooltips&&(i=u.map(r),X("update",function(t,e,r){if(i[e]){var n=t[e];!0!==f.tooltips[e]&&(n=f.tooltips[e].to(r[e])),i[e].innerHTML=n}})),X("update",function(t,e,a,r,s){g.forEach(function(t){var e=u[t],r=I(m,t,0,!0,!0,!0),n=I(m,t,100,!0,!0,!0),i=s[t],o=f.ariaFormat.to(a[t]);r=E.fromStepping(r).toFixed(1),n=E.fromStepping(n).toFixed(1),i=E.fromStepping(i).toFixed(1),e.children[0].setAttribute("aria-valuemin",r),e.children[0].setAttribute("aria-valuemax",n),e.children[0].setAttribute("aria-valuenow",i),e.children[0].setAttribute("aria-valuetext",o)})}),a}return{__spectrum:l,version:et,create:function(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider ("+et+"): create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider ("+et+"): Slider was already initialized.");var r=z(t,ut(e),e);return t.noUiSlider=r}}});

